class Solution:
    def processQueries(self, c: int, connections: List[List[int]], queries: List[List[int]]) -> List[int]:
        parent = [i for i in range(c+1)]
        size = [1]*(c+1)

        def find(node):
            while parent[node] != node:
                parent[node] = parent[parent[node]]
                node = parent[node]
            return node

        def union(a, b):
            ra, rb = find(a), find(b)
            if ra != rb:
                if size[ra] < size[rb]:
                    ra, rb = rb, ra
                parent[rb] = ra
                size[ra] += size[rb]

        for u, v in connections:
            union(u, v)

        heap = defaultdict(list)
        online = [True] * (c+1)

        for i in range(1, c+1):
            root = find(i)
            heapq.heappush(heap[root], i)

        ans = []

        for typ, n in queries:
            root = find(n)

            if typ == 2:
                online[n] = False

            else:  
                if online[n]:
                    ans.append(n)
                else:
                    h = heap[root]

                    while h and not online[h[0]]:
                        heapq.heappop(h)

                    if h:
                        ans.append(h[0])
                    else:
                        ans.append(-1)

        return ans
